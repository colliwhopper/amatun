#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f script.sh 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\272"
#define      tst2_z	19
#define      tst2	((&data[1]))
	"\165\216\016\263\007\357\030\216\160\114\156\064\142\255\331\126"
	"\210\171\303\155\206"
#define      opts_z	1
#define      opts	((&data[22]))
	"\076"
#define      msg2_z	19
#define      msg2	((&data[27]))
	"\076\230\212\100\250\126\136\143\337\146\046\051\213\034\014\150"
	"\331\326\377\207\156\017\274\230"
#define      text_z	6296
#define      text	((&data[708]))
	"\231\070\150\224\152\137\050\037\346\021\065\332\211\253\035\104"
	"\003\117\104\370\144\000\327\327\345\154\234\004\072\214\203\145"
	"\072\262\304\366\165\343\364\214\371\053\141\167\357\121\071\002"
	"\055\331\153\252\034\357\220\306\066\377\052\351\374\011\263\332"
	"\056\134\342\347\100\343\146\255\276\240\270\137\336\146\012\131"
	"\151\363\312\143\213\142\226\135\352\140\202\006\110\143\142\232"
	"\247\064\120\053\065\140\240\212\302\150\150\151\200\067\270\326"
	"\166\265\210\063\373\116\120\035\064\137\347\210\112\256\223\010"
	"\131\135\230\163\114\212\127\220\301\004\156\315\147\222\304\065"
	"\340\340\121\365\007\033\163\234\312\114\024\077\013\223\250\306"
	"\160\234\311\226\053\046\347\225\254\013\215\042\026\040\270\212"
	"\365\356\136\353\153\345\007\163\336\343\032\117\345\026\251\334"
	"\171\022\154\324\340\024\270\045\106\270\172\351\062\136\365\136"
	"\124\011\321\077\147\314\313\052\050\243\031\153\017\230\200\064"
	"\320\244\233\264\114\257\243\021\346\265\171\260\216\257\064\252"
	"\031\242\057\303\102\036\054\033\063\316\246\357\113\234\226\314"
	"\201\207\031\031\061\307\122\245\040\311\344\134\313\171\042\031"
	"\275\205\325\320\217\105\362\124\363\317\036\047\313\002\163\133"
	"\111\374\234\377\125\304\100\363\162\252\203\171\161\005\055\164"
	"\226\244\176\371\157\154\310\136\054\377\363\105\206\025\256\273"
	"\113\215\252\340\055\325\112\207\037\361\173\363\255\002\205\021"
	"\006\326\173\330\136\144\057\004\134\235\221\311\237\033\270\103"
	"\160\145\003\042\104\233\120\126\370\043\243\332\123\143\127\035"
	"\221\074\123\170\066\270\020\030\232\311\170\306\055\360\102\360"
	"\274\102\205\262\074\213\127\337\257\207\041\106\312\143\054\130"
	"\162\367\237\206\234\337\257\330\040\344\224\000\345\075\124\136"
	"\112\037\044\301\252\356\352\137\156\133\170\364\265\274\315\057"
	"\157\051\101\054\214\047\247\161\163\311\324\141\275\203\244\152"
	"\233\064\251\322\310\014\373\240\224\170\041\110\061\037\023\314"
	"\373\241\046\212\236\375\127\174\013\270\073\327\046\124\310\315"
	"\322\016\307\071\050\076\073\231\150\112\262\205\004\020\275\271"
	"\240\177\105\233\130\062\015\021\366\003\146\102\376\160\170\225"
	"\040\164\346\366\274\172\307\057\350\062\044\004\372\357\213\214"
	"\337\302\342\342\130\356\121\031\134\124\157\007\163\314\260\317"
	"\272\030\275\115\322\314\007\221\306\235\135\255\002\214\011\017"
	"\101\257\067\375\002\120\023\332\276\276\357\203\063\376\261\344"
	"\251\231\013\044\124\014\261\230\140\337\161\044\227\164\100\261"
	"\152\241\372\331\105\334\156\216\271\307\356\251\057\324\335\177"
	"\311\122\206\170\154\124\312\311\131\315\267\231\136\166\026\014"
	"\346\026\064\155\326\177\350\062\314\030\332\375\215\071\140\151"
	"\317\125\150\356\300\257\240\212\372\075\153\226\354\335\303\163"
	"\365\324\164\112\044\250\110\360\205\027\234\203\266\237\321\065"
	"\317\054\135\011\105\251\076\071\214\214\140\274\346\006\326\027"
	"\077\030\166\034\346\276\160\256\243\047\251\370\022\133\140\262"
	"\272\306\061\041\134\077\246\312\144\253\100\216\306\046\164\257"
	"\103\066\372\262\372\043\221\244\315\274\361\202\176\327\102\365"
	"\013\370\126\053\305\054\301\045\243\034\222\253\142\343\304\145"
	"\002\164\333\321\306\044\217\130\203\230\253\277\052\305\372\077"
	"\350\015\312\074\241\321\364\245\330\233\360\251\310\101\130\074"
	"\245\130\317\321\032\343\134\313\270\271\154\061\023\341\031\170"
	"\262\305\164\261\127\037\023\354\170\161\241\336\120\151\350\157"
	"\004\044\347\011\133\246\155\071\241\270\256\036\123\153\372\110"
	"\305\303\064\004\075\110\141\023\340\111\172\233\160\073\267\046"
	"\121\203\233\307\167\321\363\371\310\244\376\127\001\311\257\243"
	"\273\203\260\253\242\201\273\250\026\207\214\233\210\103\022\121"
	"\107\356\010\167\212\040\246\322\052\002\360\057\371\007\320\053"
	"\210\326\305\034\263\317\326\241\307\374\337\175\107\032\351\043"
	"\076\047\101\143\112\103\325\267\031\221\102\325\122\362\106\041"
	"\143\031\377\026\340\130\304\217\221\004\163\134\257\052\064\305"
	"\231\272\136\130\350\047\333\211\112\321\200\374\276\221\143\116"
	"\050\007\257\033\061\006\237\300\257\364\165\312\354\232\312\360"
	"\125\370\335\361\073\216\260\062\201\214\177\070\342\154\330\211"
	"\250\153\156\057\263\356\372\127\104\143\046\335\057\352\322\227"
	"\121\254\217\312\041\256\047\240\236\205\221\133\030\161\114\337"
	"\127\064\033\025\213\135\111\147\341\066\362\044\250\361\160\104"
	"\227\042\177\364\076\030\035\155\165\202\063\252\150\254\102\357"
	"\202\244\106\213\107\303\176\110\037\013\204\123\011\167\070\137"
	"\300\044\266\124\056\335\064\225\140\143\070\256\047\274\106\351"
	"\046\271\337\356\233\033\263\304\326\012\034\033\032\215\320\367"
	"\226\342\234\246\264\376\252\036\243\223\010\072\213\217\104\267"
	"\053\271\026\234\313\165\123\143\164\006\166\227\331\173\024\066"
	"\170\330\177\135\115\377\120\224\234\161\020\044\012\154\141\050"
	"\210\347\173\017\006\211\216\340\335\053\207\136\305\065\010\341"
	"\046\224\206\247\152\175\072\163\243\352\226\006\330\040\133\120"
	"\373\160\144\046\356\130\152\322\216\026\021\163\105\303\360\332"
	"\232\070\076\360\127\113\245\007\153\073\300\046\334\352\031\161"
	"\206\054\343\316\146\304\303\010\265\343\305\111\350\241\313\374"
	"\001\072\201\247\357\221\273\142\303\135\131\364\027\111\061\003"
	"\321\142\046\271\206\326\230\135\020\103\101\272\132\364\250\117"
	"\111\164\010\002\003\211\005\154\174\123\370\332\013\210\155\160"
	"\200\067\257\171\270\025\117\203\105\025\355\351\064\243\325\202"
	"\322\376\175\166\172\005\345\012\226\322\175\050\020\204\375\016"
	"\223\236\263\330\133\215\271\216\015\175\045\004\173\125\307\057"
	"\243\147\337\005\336\342\362\374\153\033\260\225\371\037\302\052"
	"\036\237\306\320\127\276\063\136\222\202\302\001\343\021\072\105"
	"\036\101\314\032\270\204\342\242\026\310\027\137\042\024\322\235"
	"\016\101\173\364\207\010\006\315\323\237\252\057\144\153\261\265"
	"\167\050\314\006\255\356\072\302\124\113\013\365\300\136\015\120"
	"\307\041\162\204\045\252\366\110\171\171\250\373\072\062\257\012"
	"\075\147\167\076\306\201\315\171\036\325\004\347\326\377\214\002"
	"\342\135\215\066\317\031\131\266\053\221\161\203\047\160\325\212"
	"\333\166\101\023\225\075\172\157\371\220\073\051\102\161\123\156"
	"\051\221\357\202\254\256\362\217\204\257\254\202\023\377\062\204"
	"\065\351\243\076\025\322\310\313\103\257\025\133\220\263\363\143"
	"\152\174\134\340\270\271\314\040\250\057\067\354\057\147\274\020"
	"\121\345\262\110\023\053\161\317\313\224\375\301\073\226\167\341"
	"\055\313\003\270\105\146\337\044\021\237\120\047\216\013\147\347"
	"\234\146\044\023\145\076\355\210\146\142\132\076\153\132\312\017"
	"\074\257\222\351\155\151\141\123\012\243\223\126\314\212\342\126"
	"\061\035\120\174\155\236\140\130\033\074\345\020\161\040\255\367"
	"\076\167\354\365\167\071\060\014\233\273\135\170\072\231\237\063"
	"\014\011\166\240\170\352\002\015\266\242\020\037\201\042\127\351"
	"\111\326\264\221\020\203\351\013\216\260\267\046\227\216\142\031"
	"\223\244\112\016\257\072\001\116\055\146\333\314\200\235\300\060"
	"\063\210\024\342\124\336\301\074\211\005\000\102\352\233\350\341"
	"\120\020\146\211\266\132\213\334\354\061\266\243\025\155\103\103"
	"\175\362\107\127\122\361\224\274\345\261\024\040\237\342\105\067"
	"\277\221\252\373\107\344\051\373\225\374\274\133\375\223\012\120"
	"\121\304\344\364\131\365\324\134\272\070\363\017\363\354\300\263"
	"\146\241\346\163\251\010\100\301\106\267\035\362\322\052\051\312"
	"\343\256\214\142\111\342\220\273\047\350\134\214\254\175\357\261"
	"\061\347\122\006\163\031\246\025\047\306\220\074\363\116\345\315"
	"\201\302\174\123\112\036\330\326\161\341\047\003\233\304\276\013"
	"\215\223\220\366\123\034\076\310\003\042\324\001\014\276\107\373"
	"\026\277\151\016\002\375\204\126\261\366\335\245\205\351\275\154"
	"\045\151\166\153\004\062\045\077\022\162\207\017\124\333\354\240"
	"\265\303\152\300\023\345\314\060\155\270\076\337\100\215\143\363"
	"\231\050\253\235\063\171\061\231\045\172\066\356\376\051\005\101"
	"\025\115\321\125\331\007\122\261\040\022\056\007\350\014\332\253"
	"\001\013\211\053\101\017\053\250\047\355\175\222\057\142\072\014"
	"\216\174\061\041\016\027\167\255\307\301\151\236\060\367\354\367"
	"\203\220\363\140\055\304\146\142\117\070\317\227\103\220\262\135"
	"\002\346\111\260\050\016\140\322\025\022\213\173\040\012\371\253"
	"\335\116\314\250\305\263\277\102\056\051\336\351\171\243\213\110"
	"\341\013\237\077\107\052\360\123\242\233\252\226\243\202\027\366"
	"\171\255\365\302\253\112\255\277\115\256\366\143\302\370\056\024"
	"\370\217\134\124\032\245\210\017\042\040\213\113\306\264\142\172"
	"\347\362\222\062\337\346\147\231\173\160\233\333\262\274\034\066"
	"\260\353\023\030\326\102\244\305\005\270\341\343\307\021\110\361"
	"\320\126\307\045\170\373\121\207\225\244\273\061\043\232\140\125"
	"\366\132\115\064\264\367\243\033\274\213\034\107\101\025\002\143"
	"\317\323\347\045\232\127\266\305\343\201\113\214\104\303\166\050"
	"\115\114\331\066\343\220\077\050\177\373\110\351\112\334\062\353"
	"\146\200\047\117\155\241\353\276\347\350\301\065\246\314\245\053"
	"\206\177\234\070\257\232\355\162\140\204\075\135\256\002\060\056"
	"\046\157\332\303\200\242\311\151\046\022\113\311\140\117\006\115"
	"\321\121\110\201\376\363\324\033\043\160\235\056\273\110\033\350"
	"\165\353\060\006\144\302\310\015\036\232\104\023\260\134\001\100"
	"\055\035\317\123\040\076\342\026\147\170\365\322\352\027\371\324"
	"\356\354\303\116\004\212\207\237\227\306\367\172\226\166\240\177"
	"\174\115\351\030\074\016\151\072\230\250\167\236\226\251\364\157"
	"\205\211\043\137\034\253\011\221\357\244\317\113\075\271\033\340"
	"\215\056\046\327\235\162\340\251\144\063\050\223\230\322\074\065"
	"\267\333\107\212\333\216\172\065\257\323\341\102\247\241\357\037"
	"\146\055\131\173\017\040\367\064\006\000\040\102\243\352\023\365"
	"\036\117\363\012\216\064\122\160\203\106\227\333\335\172\345\244"
	"\117\372\367\112\345\327\342\125\043\267\377\015\022\224\250\353"
	"\260\142\037\377\336\302\263\041\337\215\350\375\104\312\216\201"
	"\132\366\225\343\301\366\202\021\000\376\027\301\225\330\352\365"
	"\046\232\334\316\043\061\227\063\015\111\071\136\031\256\353\025"
	"\225\003\047\177\042\122\111\115\152\220\066\265\342\111\053\355"
	"\102\026\213\110\164\023\037\134\043\140\320\073\330\113\106\242"
	"\252\272\013\150\336\050\321\043\315\203\224\356\334\072\116\265"
	"\077\131\123\056\210\065\071\107\363\266\050\330\211\166\242\135"
	"\373\310\350\165\316\313\251\030\147\152\315\313\165\331\200\231"
	"\054\316\067\107\324\113\271\210\364\161\213\131\344\070\077\370"
	"\222\050\065\176\260\146\003\310\321\327\204\020\367\060\126\035"
	"\257\307\113\145\075\026\150\153\207\140\243\366\245\121\331\312"
	"\235\137\175\106\207\240\151\143\150\171\257\247\264\063\120\162"
	"\232\104\114\141\350\276\204\251\007\237\102\213\330\000\115\035"
	"\041\110\233\325\120\043\350\231\335\231\026\014\144\146\010\035"
	"\214\267\017\222\024\243\043\213\023\125\324\066\206\130\212\342"
	"\321\162\031\234\047\166\101\042\271\315\206\175\206\040\100\175"
	"\345\245\165\060\304\275\062\203\353\361\345\125\054\160\250\170"
	"\131\122\006\343\234\276\035\233\346\156\304\123\375\036\217\052"
	"\070\311\217\311\246\356\241\027\116\203\356\146\120\146\113\265"
	"\322\346\241\100\223\023\322\335\257\002\333\233\241\201\166\164"
	"\132\041\145\106\363\165\031\155\021\043\012\203\376\351\311\265"
	"\031\325\030\106\173\072\216\252\114\142\103\325\074\071\032\352"
	"\333\025\162\057\222\361\075\321\116\132\231\007\245\313\062\117"
	"\220\307\244\335\335\047\012\204\220\247\054\141\254\244\107\316"
	"\305\251\223\113\366\232\124\316\204\227\372\370\307\022\210\030"
	"\257\335\364\040\173\011\136\306\275\027\242\010\166\256\215\327"
	"\346\313\305\312\303\267\021\061\046\263\337\267\147\101\326\160"
	"\213\251\200\352\076\342\001\000\072\045\157\013\001\067\333\060"
	"\037\252\217\323\272\002\226\265\116\322\225\223\256\126\050\337"
	"\027\365\075\172\202\125\123\350\304\066\116\314\063\256\073\346"
	"\035\071\050\014\163\101\110\143\050\200\225\215\340\301\133\307"
	"\141\140\117\104\177\135\164\353\071\373\037\322\312\027\142\332"
	"\032\321\000\345\275\350\316\320\340\275\021\163\223\051\113\154"
	"\356\203\315\214\155\255\021\351\136\242\276\206\064\035\140\035"
	"\205\336\165\254\017\331\010\064\025\254\121\204\373\101\207\247"
	"\320\051\243\001\123\245\165\116\120\123\231\141\117\223\217\143"
	"\017\010\272\120\120\246\161\223\216\376\042\044\072\077\325\277"
	"\323\222\026\312\036\364\344\300\222\033\327\156\067\306\171\031"
	"\367\363\262\060\133\125\353\053\254\021\225\034\373\023\044\255"
	"\063\311\344\345\366\176\064\004\334\250\027\146\061\303\256\141"
	"\153\106\246\166\155\106\067\221\123\145\023\376\152\256\132\266"
	"\123\374\036\132\173\173\250\306\303\021\104\112\236\355\033\236"
	"\250\171\107\356\363\333\001\177\241\263\354\136\235\104\242\353"
	"\373\257\243\350\074\237\137\015\001\046\345\341\065\007\237\105"
	"\066\315\114\162\054\353\037\214\254\307\134\170\125\343\345\122"
	"\216\073\245\325\226\213\336\206\067\115\233\110\037\232\217\210"
	"\226\320\052\003\144\140\300\134\344\072\363\363\072\223\006\336"
	"\372\350\247\370\325\335\171\351\163\104\230\206\164\127\244\363"
	"\273\052\301\243\303\205\346\212\312\071\260\253\263\273\137\065"
	"\204\352\266\123\126\073\210\173\204\127\167\104\346\074\027\311"
	"\007\147\130\162\272\136\266\075\244\276\350\157\352\355\061\044"
	"\317\101\006\157\111\257\126\247\171\177\264\057\226\122\001\063"
	"\067\064\161\246\142\147\214\052\302\322\244\174\106\256\134\037"
	"\037\362\032\152\215\241\330\117\026\333\106\170\154\077\365\147"
	"\263\053\230\006\107\102\117\220\026\154\277\144\002\117\216\162"
	"\215\115\167\121\140\300\346\061\303\222\203\212\011\210\141\324"
	"\356\375\042\054\010\216\312\052\320\134\006\026\142\041\156\147"
	"\225\046\200\226\016\207\077\126\324\347\216\243\044\176\236\311"
	"\175\377\133\026\244\157\176\112\256\060\357\150\010\114\203\125"
	"\151\316\152\016\107\067\100\153\043\275\004\301\056\276\345\161"
	"\117\161\267\144\300\175\117\326\201\215\057\162\023\371\011\330"
	"\304\350\036\314\262\234\155\271\033\134\240\041\213\013\104\237"
	"\214\013\167\227\263\177\237\323\360\223\053\372\053\007\220\037"
	"\067\124\301\011\250\046\313\056\250\173\075\123\152\352\031\076"
	"\242\261\126\010\153\252\366\112\313\155\063\143\023\204\300\373"
	"\020\250\254\015\001\073\031\206\032\105\061\303\343\052\265\374"
	"\227\043\323\332\247\045\124\030\036\237\024\105\331\020\221\236"
	"\007\330\166\302\233\350\134\112\143\340\322\236\374\146\177\035"
	"\015\260\103\215\367\061\037\110\112\161\343\106\247\235\121\247"
	"\201\172\017\173\344\203\033\243\034\054\144\064\121\145\263\342"
	"\151\124\314\150\105\332\261\230\106\163\027\070\225\320\155\264"
	"\323\365\004\244\347\163\041\272\014\334\374\105\231\271\141\042"
	"\347\324\166\003\151\004\314\073\242\256\137\303\134\134\211\252"
	"\176\041\103\232\204\235\002\000\122\106\265\326\215\033\304\213"
	"\046\163\116\115\303\203\055\273\160\351\234\067\352\263\331\106"
	"\376\177\231\007\033\240\240\363\154\376\254\025\023\304\127\035"
	"\026\303\053\224\375\312\120\021\375\245\144\052\303\050\123\135"
	"\337\116\375\336\325\307\132\277\071\257\033\367\223\042\020\337"
	"\021\116\365\070\175\173\165\270\135\360\036\350\225\234\201\323"
	"\217\000\124\224\356\213\262\207\030\063\324\203\112\161\107\342"
	"\164\253\155\222\316\021\146\024\365\003\336\166\160\110\126\075"
	"\205\247\312\044\204\175\225\321\137\343\030\375\153\043\324\362"
	"\344\352\077\217\072\035\165\357\043\055\213\151\264\152\141\244"
	"\322\040\206\243\026\336\261\204\317\166\361\355\143\017\354\333"
	"\075\047\366\355\016\216\106\262\110\242\052\132\360\374\155\126"
	"\101\055\055\126\012\243\223\047\043\176\163\274\313\026\345\052"
	"\340\273\346\105\254\107\030\010\361\165\376\256\277\324\342\122"
	"\150\340\374\030\167\134\244\300\124\123\153\071\042\161\267\063"
	"\020\106\331\341\324\265\170\146\121\250\235\044\024\346\053\374"
	"\223\061\141\045\054\242\175\000\012\263\342\252\353\054\351\321"
	"\155\136\257\156\305\043\377\064\057\145\272\221\300\244\244\254"
	"\140\303\134\211\014\315\147\213\152\120\117\256\140\105\054\122"
	"\073\340\220\146\367\261\272\235\345\161\001\026\146\110\334\110"
	"\166\140\140\305\076\064\240\006\113\313\203\204\041\044\201\315"
	"\174\327\151\246\201\253\221\174\175\163\353\031\261\362\252\062"
	"\312\323\354\127\307\243\117\240\160\033\257\057\023\045\145\300"
	"\271\177\166\331\024\173\005\101\222\017\175\277\276\034\241\071"
	"\376\307\356\127\027\372\032\216\040\037\153\277\232\144\163\051"
	"\377\333\213\322\216\333\151\043\175\161\303\264\100\141\221\046"
	"\256\062\061\126\220\326\240\142\353\070\357\065\341\264\134\210"
	"\063\146\374\075\241\031\143\251\225\377\213\356\051\273\371\361"
	"\371\134\017\372\231\103\263\100\302\340\177\373\075\337\136\365"
	"\002\050\252\032\376\021\171\274\061\340\057\212\264\166\312\210"
	"\167\312\336\241\040\011\344\273\246\227\373\241\124\154\303\150"
	"\267\322\057\162\177\342\116\023\004\101\157\243\352\316\327\313"
	"\237\244\214\233\137\222\032\115\036\065\324\267\272\225\232\164"
	"\110\167\022\270\062\112\170\342\376\176\035\154\123\276\326\245"
	"\163\016\053\225\205\067\044\132\344\201\251\213\216\355\252\176"
	"\155\354\132\135\175\237\302\017\217\031\042\341\132\150\130\317"
	"\225\247\267\037\335\211\306\215\055\253\175\271\350\326\336\133"
	"\220\375\051\352\313\244\325\307\234\203\053\163\206\001\141\056"
	"\356\001\301\363\037\010\367\125\055\377\337\361\312\026\044\350"
	"\123\210\323\201\377\142\230\320\145\262\230\203\360\136\043\057"
	"\061\172\036\204\200\304\277\144\107\016\357\241\265\270\313\353"
	"\364\331\153\325\147\213\106\122\216\102\027\130\214\110\274\331"
	"\047\033\246\257\224\041\374\355\131\111\024\315\176\026\045\075"
	"\137\044\131\033\167\270\305\176\266\367\247\052\164\144\372\003"
	"\053\017\162\230\046\311\030\322\211\352\163\115\220\164\064\106"
	"\344\353\047\301\107\027\045\104\060\311\230\037\052\317\143\265"
	"\057\103\347\245\143\246\050\347\007\016\361\147\267\102\077\147"
	"\347\317\175\275\243\313\333\345\300\224\303\300\022\120\332\205"
	"\235\310\121\156\207\165\255\060\071\044\006\375\267\243\216\053"
	"\017\245\011\214\071\063\164\302\106\264\116\112\002\355\214\034"
	"\211\372\165\151\051\352\021\162\103\043\070\201\032\011\370\250"
	"\245\343\370\344\306\225\052\012\210\375\133\312\275\126\014\004"
	"\032\311\122\264\073\303\255\123\363\204\251\147\263\362\061\030"
	"\324\374\306\161\225\121\377\346\356\141\107\141\074\333\141\317"
	"\371\334\243\251\137\377\346\104\230\352\044\337\145\044\373\061"
	"\350\263\304\354\130\372\076\331\255\050\226\102\166\053\264\320"
	"\246\216\341\267\233\105\231\361\045\321\112\024\033\265\223\354"
	"\201\214\113\067\316\135\113\077\064\276\146\311\032\167\226\010"
	"\250\115\267\114\077\062\056\013\316\100\357\344\033\273\162\107"
	"\063\334\056\351\235\321\174\030\154\151\251\121\116\061\213\352"
	"\073\126\253\231\143\124\351\327\215\054\326\037\215\063\172\373"
	"\224\302\125\024\074\053\315\104\041\214\046\234\107\236\303\154"
	"\034\022\343\076\002\073\325\221\051\155\262\176\311\202\200\370"
	"\325\064\241\017\327\345\276\022\106\215\372\272\313\307\166\131"
	"\316\065\152\355\045\357\263\162\205\057\203\305\000\117\377\122"
	"\261\011\003\177\076\357\107\140\076\326\224\066\175\116\123\363"
	"\070\013\162\022\307\177\177\337\217\221\204\157\050\073\257\372"
	"\237\130\041\102\321\215\022\111\356\206\301\251\213\347\323\145"
	"\012\065\156\215\216\345\154\011\014\125\037\024\313\067\074\007"
	"\131\174\050\056\320\234\361\205\001\005\163\354\370\227\012\034"
	"\273\026\376\302\203\264\376\061\273\112\011\053\265\222\017\311"
	"\173\233\032\056\314\156\234\072\176\374\322\364\146\333\156\340"
	"\110\375\361\051\015\005\142\134\173\300\016\053\243\365\130\371"
	"\104\217\344\015\100\152\141\131\303\323\221\233\376\074\022\335"
	"\204\247\356\145\073\113\023\222\367\113\050\011\330\007\022\142"
	"\134\176\316\071\123\124\117\140\156\374\165\307\213\033\075\202"
	"\236\161\265\073\320\324\134\337\176\351\341\054\332\137\134\233"
	"\353\075\152\111\113\331\312\137\234\313\010\236\307\166\024\015"
	"\300\032\254\164\325\354\042\361\101\177\042\145\321\025\173\114"
	"\150\020\270\077\033\335\343\310\305\024\011\065\321\010\043\304"
	"\213\365\134\255\364\275\164\137\160\063\107\256\326\077\030\024"
	"\267\335\326\057\367\111\060\272\071\054\141\124\317\070\117\237"
	"\340\257\137\307\304\045\067\267\357\002\063\346\326\056\072\377"
	"\362\031\134\347\353\341\005\072\345\042\212\212\132\370\071\147"
	"\121\320\021\135\143\342\050\142\105\312\206\020\250\216\204\210"
	"\057\241\052\276\225\336\135\236\370\233\043\152\047\304\176\205"
	"\113\233\044\262\270\364\114\357\266\224\202\244\233\113\210\030"
	"\331\315\376\036\305\020\277\166\263\304\314\017\251\207\302\024"
	"\022\220\216\313\161\265\246\073\220\321\336\375\166\270\162\011"
	"\022\265\351\157\327\046\217\153\027\333\063\234\276\372\116\334"
	"\070\316\351\312\036\236\116\227\232\011\113\153\013\326\223\136"
	"\064\177\311\202\057\272\250\024\234\224\253\236\123\220\100\005"
	"\162\042\251\021\014\005\327\366\304\070\317\317\044\361\336\364"
	"\024\252\021\354\357\232\224\224\241\332\150\140\111\334\363\002"
	"\262\013\346\025\130\310\307\060\055\343\340\017\013\141\105\163"
	"\146\112\113\132\116\240\055\232\132\003\252\105\170\025\252\147"
	"\300\260\105\337\176\267\046\376\037\162\044\270\357\162\363\340"
	"\375\024\274\166\020\223\030\350\322\215\256\230\360\330\221\107"
	"\067\271\121\052\360\136\230\173\112\057\136\203\061\251\347\155"
	"\314\077\132\046\173\117\266\374\102\234\232\330\200\206\147\053"
	"\163\116\135\305\235\264\363\235\122\054\355\066\002\236\104\326"
	"\225\167\315\076\265\005\246\303\011\045\344\130\306\251\127\311"
	"\363\162\214\151\003\355\060\344\150\315\025\176\002\120\127\137"
	"\133\367\024\215\330\143\363\375\202\001\111\335\240\215\224\034"
	"\170\372\067\353\322\034\030\064\042\027\330\111\061\310\200\177"
	"\157\245\063\110\223\144\163\100\075\317\331\204\010\023\123\330"
	"\040\032\262\033\205\302\024\203\254\133\023\000\155\077\131\221"
	"\365\013\054\133\200\026\115\357\007\012\337\015\347\363\051\123"
	"\133\250\116\312\126\367\276\050\146\070\065\052\074\232\022\055"
	"\153\236\203\376\352\366\170\002\036\273\166\333\030\370\255\147"
	"\344\361\170\317\222\170\372\131\070\022\154\157\267\254\312\037"
	"\256\221\175\050\120\231\304\111\250\205\207\121\155\122\030\027"
	"\311\011\115\020\347\066\264\060\314\276\235\204\312\007\202\307"
	"\113\030\144\172\052\110\124\215\030\367\167\273\017\102\347\223"
	"\370\041\025\010\200\260\051\116\004\020\105\372\055\267\070\165"
	"\135\073\213\177\053\351\227\245\316\160\175\270\020\365\042\355"
	"\016\075\017\016\142\361\177\334\127\206\315\363\010\212\270\352"
	"\066\157\246\345\046\340\152\311\314\025\070\176\010\050\223\164"
	"\351\147\302\131\102\301\005\230\352\047\350\212\365\213\232\241"
	"\054\266\311\062\375\110\210\030\336\133\357\304\173\057\200\257"
	"\365\350\074\252\175\377\376\316\270\373\352\176\305\031\123\165"
	"\212\250\072\321\140\336\373\021\253\132\050\312\236\365\155\210"
	"\066\031\262\044\352\376\044\262\041\215\201\166\002\200\302\164"
	"\324\313\064\124\050\135\124\142\137\377\322\002\232\071\057\052"
	"\233\256\342\000\252\256\233\176\370\257\344\030\011\344\076\016"
	"\002\141\306\055\265\344\346\042\345\267\041\371\344\115\303\175"
	"\115\267\263\037\302\107\125\032\374\137\050\157\250\175\351\367"
	"\010\352\171\100\274\226\363\222\206\200\111\012\042\061\304\051"
	"\303\241\062\360\252\173\137\221\025\330\226\274\300\255\014\245"
	"\327\056\167\346\321\254\262\133\233\277\167\242\241\227\103\364"
	"\316\054\037\345\354\313\276\267\253\062\356\214\234\113\003\172"
	"\277\120\070\324\153\202\212\054\170\112\236\274\132\107\231\172"
	"\146\053\063\104\046\340\022\017\245\027\232\254\173\323\117\234"
	"\046\310\042\365\345\214\222\243\016\332\065\216\033\060\120\064"
	"\252\106\274\231\012\037\230\017\353\251\224\206\215\267\035\355"
	"\210\225\011\073\330\234\276\340\177\115\010\176\106\143\106\345"
	"\171\251\326\153\315\364\121\156\370\251\137\350\301\323\316\157"
	"\057\065\210\021\375\361\026\102\360\332\305\014\315\003\051\326"
	"\176\171\123\113\042\315\310\062\264\332\072\160\017\021\203\274"
	"\257\054\041\332\171\223\123\222\244\365\232\306\077\004\100\222"
	"\103\160\150\350\035\026\371\034\076\274\337\072\162\371\147\257"
	"\143\224\136\016\117\023\022\365\372\136\024\225\246\144\370\017"
	"\237\024\272\261\044\143\224\330\156\203\315\077\054\164\034\333"
	"\317\047\302\377\220\047\143\317\264\177\331\202\103\157\077\040"
	"\024\316\010\305\170\377\124\101\130\246\071\304\064\105\330\054"
	"\246\017\207\010\373\271\326\105\213\052\234\142\375\373\100\025"
	"\356\021\167\110\063\135\011\316\060\324\177\210\377\012\254\344"
	"\151\104\115\157\173\336\257\162\160\372\231\336\225\273\175\224"
	"\012\230\352\250\134\365\242\075\156\372\107\157\137\346\361\031"
	"\011\245\375\165\016\000\133\267\014\075\205\323\017\152\313\263"
	"\162\002\131\225\366\156\114\345\276\106\202\331\356\106\323\233"
	"\055\341\173\304\202\211\303\055\255\033\322\026\160\306\320\317"
	"\153\056\353\262\135\333\030\260\247\107\126\133\257\235\267\132"
	"\270\257\146\272\120\361\051\137\201\321\005\357\056\223\146\271"
	"\130\047\245\256\216\272\114\077\130\346\132\045\300\130\342\153"
	"\173\372\071\045\040\216\310\073\074\132\105\267\200\061\076\245"
	"\016\166\170\242\103\114\177\102\303\134\212\101\251\263\142\335"
	"\260\300\247\062\115\001\253\233\045\055\163\244\311\044\047\146"
	"\305\033\135\303\351\140\364\061\163\131\000\265\056\123\354\061"
	"\164\310\164\012\324\311\373\213\123\322\260\176\235\017\031\173"
	"\173\263\076\166\101\115\037\027\011\123\136\266\332\004\375\104"
	"\116\233\206\014\007\273\305\036\040\041\333\034\067\361\177\150"
	"\047\337\034\161\134\023\373\010\040\350\324\305\060\250\103\304"
	"\027\305\232\061\242\322\337\220\205\034\262\275\275\231\311\006"
	"\050\000\242\142\246\060\257\002\105\245\116\114\066\346\343\040"
	"\335\040\075\240\244\177\332\244\070\340\065\147\332\276\103\106"
	"\306\121\222\141\006\214\074\145\177\231\143\000\061\311\124\175"
	"\250\005\141\102\255\057\031\022\001\051\370\330\316\131\305\005"
	"\037\146\053\106\134\000\300\252\203\102\021\053\371\355\266\327"
	"\246\174\126\016\056\204\174\157\165\010\334\117\062\052\023\261"
	"\113\260\362\254\342\203\011\020\244\330\010\356\221\172\250\175"
	"\147\243\247\104\142\143\261\076\212\343\261\272\147\020\055\212"
	"\127\215\205\313\220\131\241\212\301\015\344\353\136\133\143\341"
	"\227\240\051\237\255\023\132\163\001\067\314\270\130\351\003\321"
	"\140\241\141\073\233\104\026\074\006\032\213\232\017\170\265\332"
	"\001\341\143\337\377\211\262\206\023\354\001\313\112\343\365\075"
	"\034\033\167\225\074\126\166\321\100\204\161\165\041\131\236\102"
	"\125\367\311\323\360\171\367\173\205\363\300\040\314\207\115\327"
	"\025\166\006\041\060\337\371\153\225\051\257\170\003\052\030\217"
	"\021\057\262\232\272\254\252\317\173\353\263\156\134\070\371\330"
	"\355\141\201\147\301\045\330\035\074\125\333\023\074\157\131\317"
	"\216\354\052\243\072\157\077\163\336\254\372\316\344\226\301\137"
	"\152\121\243\000\076\307\370\121\122\156\154\124\121\216\357\253"
	"\362\064\012\357\237\145\004\126\205\234\217\076\201\072\030\007"
	"\374\166\142\372\306\072\333\165\017\244\313\005\040\336\102\260"
	"\036\172\105\350\137\127\326\077\345\202\014\134\374\312\230\270"
	"\100\144\231\240\332\241\124\223\102\326\203\016\377\263\157\303"
	"\250\176\105\234\333\305\063\056\332\203\254\026\060\306\162\133"
	"\226\167\176\121\207\360\375\171\327\140\151\173\054\056\154\145"
	"\230\120\102\065\307\115\334\232\101\300\371\253\301\372\327\103"
	"\041\015\222\172\105\377\242\235\273\370\175\321\015\171\377\063"
	"\073\060\352\251\240\336\312\077\032\076\206\016\174\256\001\000"
	"\026\123\377\171\117\244\104\073\337\277\012\330\231\173\052\051"
	"\303\126\037\154\111\011\347\331\173\174\351\307\365\337\357\146"
	"\104\171\212\316\043\152\073\367\076\031\365\023\055\053\360\057"
	"\011\127\106\312\307\271\041\322\043\363\163\056\204\230\242\236"
	"\131\221\175\166\335\233\260\127\165\267\114\024\256\055\102\040"
	"\115\304\315\132\046\123\363\060\042\370\011\227\363\152\226\202"
	"\351\317\156\273\104\351\334\366\133\330\004\053\343\257\076\154"
	"\013\320\246\171\122\110\013\372\000\064\265\131\034\244\033\175"
	"\130\111\271\334\153\327\351\337\123\062\262\050\046\342\314\250"
	"\303\056\211\240\273\077\026\256\205\114\143\317\340\132\112\236"
	"\375\123\304\332\135\175\206\012\132\217\334\356\377\070\260\106"
	"\217\077\111\302\232\146\270\232\105\246\055\331\157\143\145\062"
	"\341\276\203\360\214\220\224\053\161\072\115\337\354\122\247\377"
	"\210\237\031\005\066\311\261\005\217\013\104\253\101\026\205\361"
	"\007\171\275\122\122\120\306\166\311\317\232\046\236\330\343\024"
	"\045\342\034\116\275\316\166\327\337\330\204\343\023\157\144\061"
	"\150\367\246\053\372\024\032\135\357\256\236\207\330\353\042\125"
	"\053\333\225\277\067\356\143\141\315\256\206\100\065\374\352\366"
	"\276\264\120\120\152\354\147\350\323\050\232\055\017\201\341\306"
	"\365\207\107\013\343\254\231\141\230\343\267\344\376\016\020\302"
	"\305\073\273\040\323\175\031\074\125\132\134\173\107\015\015\012"
	"\234\303\127\327\237\332\050\271\115\027\260\160\003\047\165\277"
	"\222\246\231\312\215\064\307\327\131\040\103\272\011\104\015\177"
	"\316\314\353\075\342\203\014\002\014\211\044\325\235\155\262\051"
	"\335\013\335\205\134\346\232\127\264\104\055\004\035\177\077\043"
	"\265\045\247\235\373\004\115\050\070\221\344\010\006\132\266\367"
	"\105\307\366\160\323\300\160\027\202\053\154\010\353\114\126\177"
	"\335\265\254\136\266\266\223\204\104\275\355\017\140\312\313\046"
	"\277\010\176\077\252\155\032\031\160\075\303\156\023\326\062\161"
	"\276\205\012\027\053\254\114\361\063\061\364\031\071\162\271\313"
	"\202\027\304\032\351\337\230\067\324\331\152\332\221\155\205\035"
	"\270\026\045\107\313\233\120\074\117\160\064\210\320\061\272\066"
	"\374\172\102\053\227\253\342\042\257\263\366\277\135\232\204\372"
	"\033\001\323\343\227\237\304\013\043\256\151\304\143\335\307\210"
	"\355\202\010\135\337\210\262\236\057\056\304\133\256\264\322\174"
	"\060\312\377\362\214\214\362\065\374\021\077\202\323\306\113\023"
	"\346\151\346\332\130\007\214\163\023\133\224\177\243\153\314\147"
	"\355\304\324\137\323\045\122\312\244\357\026\116\246\044\022\304"
	"\000\005\110\331\105\101\111\153\174\232\134\264\067\104\100\231"
	"\114\317\232\304\030\162\215\347\103\247\330\336\052\251\231\230"
	"\321\114\226\001\313\251\122\301\123\106\211\121\050\136\102\113"
	"\267\061\355\270\213\207\070\276\300\213\020\176\022\345\177\126"
	"\260\151\221\267\143\254\170\111\311\312\226\137\116\013\204\312"
	"\042\016\303\205\137\320"
#define      xecc_z	15
#define      xecc	((&data[7335]))
	"\244\313\366\312\100\261\372\144\170\314\167\107\232\242\375\372"
	"\374"
#define      inlo_z	3
#define      inlo	((&data[7350]))
	"\316\061\026"
#define      date_z	1
#define      date	((&data[7353]))
	"\021"
#define      chk2_z	19
#define      chk2	((&data[7358]))
	"\020\272\160\331\362\262\246\140\215\054\325\127\214\133\162\354"
	"\221\331\017\066\255\153\261\302\134\060\312"
#define      pswd_z	256
#define      pswd	((&data[7393]))
	"\213\215\221\121\220\115\150\332\207\353\146\375\306\231\350\205"
	"\315\236\117\206\260\061\236\017\247\152\124\001\044\257\246\310"
	"\354\205\251\045\171\137\171\106\157\052\332\132\044\235\202\065"
	"\201\145\311\310\205\075\215\243\207\356\037\212\257\300\264\314"
	"\375\240\073\157\034\370\363\141\157\124\334\061\105\111\006\034"
	"\032\200\012\161\015\262\373\266\317\154\240\213\126\005\004\134"
	"\213\213\111\377\042\220\247\377\136\134\013\365\302\000\146\022"
	"\141\065\001\251\366\267\267\073\027\133\363\154\375\222\250\103"
	"\126\363\204\303\165\353\314\075\300\250\374\160\346\127\100\247"
	"\166\113\220\321\252\321\222\052\173\033\362\205\370\357\277\045"
	"\175\213\067\355\104\207\276\337\167\013\030\205\304\140\055\221"
	"\047\315\160\064\370\046\060\322\362\143\326\132\354\241\206\160"
	"\220\217\376\135\266\114\356\072\135\205\040\016\055\071\012\072"
	"\301\255\022\273\212\044\114\264\210\215\334\003\303\334\172\232"
	"\325\214\362\220\052\172\262\111\327\343\250\102\306\247\050\235"
	"\317\363\202\331\261\157\373\076\242\260\024\234\236\376\224\170"
	"\351\034\165\254\050\362\077\162\360\374\357\145\341\222\264\162"
	"\143\136\342\100\220\212\305\147\321\357\062\227\003\330\352\230"
	"\263\164\214\235\220\135\331\165\060\337\015\341\346\356\215\325"
	"\022\342\114\306\313\341\121\037\327\060\142\123\360\362\266\361"
	"\303\065\101\362"
#define      shll_z	8
#define      shll	((&data[7706]))
	"\015\013\252\317\123\324\124\237\337\024\125"
#define      msg1_z	65
#define      msg1	((&data[7725]))
	"\306\224\234\107\141\206\170\000\112\371\211\017\074\367\132\224"
	"\132\037\216\307\064\270\103\053\265\376\150\324\163\100\124\162"
	"\027\067\001\372\236\114\366\070\266\271\230\115\314\044\041\022"
	"\352\311\214\102\324\355\145\004\163\044\077\013\367\070\325\006"
	"\006\322\132\061\135\046\321\341\077\237\365\366\030\137\312\075"
	"\337\050\025\252\072\263\275"
#define      tst1_z	22
#define      tst1	((&data[7808]))
	"\346\256\346\111\125\015\205\232\363\207\272\344\274\373\051\143"
	"\010\036\271\041\131\001\110\313\202\044\117"
#define      chk1_z	22
#define      chk1	((&data[7830]))
	"\055\145\104\025\172\306\112\362\053\232\070\110\173\126\240\312"
	"\352\250\324\171\321\050"
#define      lsto_z	1
#define      lsto	((&data[7852]))
	"\331"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
